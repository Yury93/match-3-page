window.__require=function e(t,o,n){function i(c,s){if(!o[c]){if(!t[c]){var a=c.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var u=o[c]={exports:{}};t[c][0].call(u.exports,function(e){return i(t[c][1][e]||e)},u,u.exports,e,t,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({"abstract-machanic":[function(e,t,o){"use strict";cc._RF.push(t,"4087dTF1DBMPasvTIMFzaFf","abstract-machanic"),Object.defineProperty(o,"__esModule",{value:!0}),o.AbstractMechanic=void 0;var n=function(){function e(){}return e.prototype.onTurnEnd=function(){throw new Error("Method not implemented.")},e.prototype.onTileClick=function(){throw new Error("Method not implemented.")},e.prototype.dropTiles=function(e){for(var t=e.getTileCount(),o=t.columns,n=t.rows,i=0;i<o;i++)for(var r=n-1;r>=0;r--)if(!e.getTile(i,r))for(var c=r-1;c>=0;c--){var s=e.getTile(i,c);if(s){e.setTile(i,r,s),e.setTile(i,c,null),e.moveTile(s,e.getCell(i,r).getPosition()),e.getCell(i,r).setFree(!1),e.getCell(i,c).setFree(!0);break}}},e.prototype.fillEmpty=function(e){for(var t=e.getTileCount(),o=t.columns,n=t.rows,i=0;i<o;i++)for(var r=0;r<n;r++)if(!e.getTile(i,r)){var c=e.getCell(i,r),s=e.createRandomTile(c);e.setTile(i,r,s),c.setFree(!1),e.addTile(s,c)}},e}();o.AbstractMechanic=n,cc._RF.pop()},{}],"asset-provider":[function(e,t,o){"use strict";cc._RF.push(t,"0e0c2jhz8xFuIYXqwXL54UA","asset-provider");var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function c(e){try{a(n.next(e))}catch(t){r(t)}}function s(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,n=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(s){r=[6,s],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.AssetProvider=void 0;var r=function(){function e(){this._assets={}}return e.prototype.loadAsset=function(e){return n(this,void 0,Promise,function(){var t=this;return i(this,function(){return this._assets[e]?[2,this._assets[e]]:[2,new Promise(function(o,n){cc.resources.load(e,function(i,r){if(i)return console.error("Failed to load asset: "+e,i),void n(i);t._assets[e]=r,o(r)})})]})})},e.prototype.getAsset=function(e){return this._assets[e]},e.prototype.instantiateAsset=function(e){return this._assets[e]?cc.instantiate(this._assets[e]):(console.error("Asset not found: "+e),null)},e.prototype.unloadAsset=function(e){console.log("Unloading asset: "+e),cc.resources.release(this._assets[e]),delete this._assets[e]},e}();o.AssetProvider=r,cc._RF.pop()},{}],"basic-mechanic":[function(e,t,o){"use strict";cc._RF.push(t,"b7740EWJ5tK7pmA/ZOz0Zh0","basic-mechanic");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.BasicMechanic=void 0;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onTileClick=function(e,t){var o=this.findConnectedTiles(e,t);return!(o.length<2||(this.burnTiles(o,t),this.dropTiles(t),this.fillEmpty(t),t.onBurn&&t.onBurn(o.length),0))},t.prototype.onTurnEnd=function(){},t.prototype.findConnectedTiles=function(e,t){for(var o=t.getTileCount(),n=o.columns,i=o.rows,r=new Set,c=[e],s=e.tileType,a=[[-1,0],[1,0],[0,-1],[0,1]];c.length>0;){var l=c.pop();if(l&&!r.has(l)&&l.tileType===s){r.add(l);for(var u=t.getTilePosition(l),p=u.col,h=u.row,f=0;f<a.length;f++){var _=a[f],d=p+_[0],v=h+_[1];if(d>=0&&d<n&&v>=0&&v<i){var y=t.getTile(d,v);y&&!r.has(y)&&y.tileType===s&&c.push(y)}}}}return Array.from(r)},t.prototype.burnTiles=function(e,t){e.forEach(function(e){var o=t.getTilePosition(e),n=o.col,i=o.row;n>=0&&i>=0&&(t.removeTile(e),t.setTile(n,i,null),t.getCell(n,i).setFree(!0))})},t}(e("./abstract-machanic").AbstractMechanic);o.BasicMechanic=r,cc._RF.pop()},{"./abstract-machanic":"abstract-machanic"}],"booster-bomb":[function(e,t,o){"use strict";cc._RF.push(t,"a821cDQs75GZb3AVOrvIUyQ","booster-bomb");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterBomb=void 0;var r=e("../../configs/configs"),c=function(e){function t(t){var o=e.call(this)||this;return o._gameFactory=t,o.RADIUS=r.CONSTANTS.boosterBombR,o}return i(t,e),t.prototype.onTurnEnd=function(){},t.prototype.onTileClick=function(e,t){this.playEffectExplosion(e);var o=t.getTilePosition(e),n=o.col,i=o.row;if(n<0||i<0)return!1;for(var r=t.getTileCount(),c=r.columns,s=r.rows,a=[],l=-this.RADIUS;l<=this.RADIUS;l++)for(var u=-this.RADIUS;u<=this.RADIUS;u++){var p=n+l,h=i+u;if(p>=0&&p<c&&h>=0&&h<s){var f=t.getTile(p,h);f&&a.push(f)}}return 0!==a.length&&(a.forEach(function(e){var o=t.getTilePosition(e);t.removeTile(e),t.setTile(o.col,o.row,null),t.getCell(o.col,o.row).setFree(!0)}),this.dropTiles(t),this.fillEmpty(t),t.onBurn&&t.onBurn(a.length),!0)},t.prototype.playEffectExplosion=function(e){var t=this._gameFactory.createBombEffect(e.sprite.node).getComponent(cc.Sprite);t.node.active=!0,t.node.opacity=0,cc.tween(t.node).to(.3,{opacity:255},{easing:cc.easing.sineOut}).delay(1).to(.3,{opacity:0},{easing:cc.easing.sineIn}).delay(.3).call(function(){t.node.destroy()}).start()},t}(e("./abstract-machanic").AbstractMechanic);o.BoosterBomb=c,cc._RF.pop()},{"../../configs/configs":"configs","./abstract-machanic":"abstract-machanic"}],configs:[function(e,t,o){"use strict";cc._RF.push(t,"cc9b28JaFxFzoHL/6aJzNPq","configs"),Object.defineProperty(o,"__esModule",{value:!0}),o.TILE_MODELS=o.PREFABS=o.GLOBAL_GAME_CONFIGS=o.CONSTANTS=o.TABLE=void 0;var n=e("../logic/tile-type");o.TABLE=[{column:9,lines:9,grid:95},{column:3,lines:3,grid:95}];var i=[{maxSteps:35,winScoreThreshold:250},{maxSteps:40,winScoreThreshold:300},{maxSteps:30,winScoreThreshold:200},{maxSteps:30,winScoreThreshold:100}],r=i[Math.floor(Math.random()*i.length)];o.CONSTANTS={boosterBombR:1};var c=[{formula:function(e){return e*e*5}},{formula:function(e){return e}}];o.GLOBAL_GAME_CONFIGS={MaxStep:r.maxSteps,WinScoreThreshold:r.winScoreThreshold,_scoreFormulaIndex:1,get ScoreFormula(){return c[this._scoreFormulaIndex].formula}},o.PREFABS={tablePrefab:"table/Table",UIPanelPrefab:"table/UI",BombEffectPrefab:"table/ExplosionEffect",tilePrefab:"tiles/TilePrefab",curtainPrefab:"curtain/Curtain"},o.TILE_MODELS=[{path:"tiles/block_blue",type:n.TileType.BLUE},{path:"tiles/block_green",type:n.TileType.GREEN},{path:"tiles/block_purpure",type:n.TileType.PURPLE},{path:"tiles/block_red",type:n.TileType.RED},{path:"tiles/block_yellow",type:n.TileType.YELLOW}],cc._RF.pop()},{"../logic/tile-type":"tile-type"}],"create-content-state":[function(e,t,o){"use strict";cc._RF.push(t,"1697280MopCpYIN+QlXWY/d","create-content-state");var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function c(e){try{a(n.next(e))}catch(t){r(t)}}function s(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,n=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(s){r=[6,s],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.CreateContentState=void 0;var r=e("../state-machine/state-names"),c=function(){function e(e,t,o){this._tableView=null,this._tableCell=null,this._uiPanelView=null,this._isLoadAssets=!1,this._stateMachine=e,this._gameFactory=t,this._mechanicService=o}return e.prototype.run=function(){return n(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return console.log("run create content state"),this._isLoadAssets?[3,2]:[4,this._gameFactory.loadAssets()];case 1:e.sent(),this._isLoadAssets=!0,e.label=2;case 2:return this.createContent(),[2]}})})},e.prototype.createContent=function(){null===this._tableView&&(this._tableView=this._gameFactory.createTableView()),null===this._uiPanelView&&(this._uiPanelView=this._gameFactory.createUiPanelView());var e=this._tableView.getContent();this._tableCell=this._gameFactory.createTableCells(e);var t=this._gameFactory.createTiles(this._tableCell,e),o=this._gameFactory.createTableModel(this._tableCell,t),n=this._gameFactory.createTableController(this._tableView,o,this._mechanicService),i=this._uiPanelView;this._stateMachine.run(r.StateNames.GameLoop,{tableModel:o,tableController:n,uiPanelView:i})},e.prototype.stop=function(){console.log("stop create content state")},e}();o.CreateContentState=c,cc._RF.pop()},{"../state-machine/state-names":"state-names"}],curtain:[function(e,t,o){"use strict";cc._RF.push(t,"8309dgtnxtJqLUdtZYjvtY0","curtain");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resultLabel=null,t.restartButton=null,t.continueButton=null,t.fadeSprite=null,t.curtainSprite=null,t._startPosCurtain=null,t}return i(t,e),t.prototype.win=function(){this.showResult(this.continueButton,"\u0423\u0441\u043f\u0435\u0445!")},t.prototype.lose=function(){this.showResult(this.restartButton,"\u041d\u0435\u0443\u0434\u0430\u0447\u0430!")},t.prototype.showResult=function(e,t){var o=this;this.subscribeButtonEvents(),this._startPosCurtain=this.curtainSprite.node.position,this.resultLabel.string="",this.showFade(!0),this.showCurtain(function(){e.node.active=!0,o.resultLabel.string=t}).start()},t.prototype.clickRestart=function(){var e=this;this.unsubscribeButtonEvents(),this.showCurtain(function(){e.showFade(!1),e.resultLabel.node.active=!1,e.restartButton.node.active=!1,e.onRestart&&e.onRestart()}).call(function(){e.node.destroy()}).start()},t.prototype.clickContinue=function(){var e=this;this.subscribeButtonEvents(),this.showCurtain(function(){e.showFade(!1),e.resultLabel.node.active=!1,e.continueButton.node.active=!1,e.onContinue&&e.onContinue()}).call(function(){e.node.destroy()}).start()},t.prototype.showFade=function(e){e?cc.tween(this.fadeSprite.node).to(.5,{opacity:170}).start():cc.tween(this.fadeSprite.node).to(.5,{opacity:0}).start()},t.prototype.showCurtain=function(e){return cc.Tween.stopAllByTarget(this.curtainSprite.node),cc.tween(this.curtainSprite.node).to(.3,{x:0},{easing:"quadOut"}).call(function(){e&&e()}).delay(1).to(.3,{x:this._startPosCurtain.x},{easing:"quadOut"})},t.prototype.subscribeButtonEvents=function(){this.restartButton.node.on(cc.Node.EventType.TOUCH_END,this.clickRestart,this),this.continueButton.node.on(cc.Node.EventType.TOUCH_END,this.clickContinue,this)},t.prototype.unsubscribeButtonEvents=function(){this.restartButton.node.off(cc.Node.EventType.TOUCH_END,this.clickRestart,this),this.continueButton.node.off(cc.Node.EventType.TOUCH_END,this.clickContinue,this)},t.prototype.onDestroy=function(){this.curtainSprite&&this.curtainSprite.node&&cc.Tween.stopAllByTarget(this.curtainSprite.node),this.fadeSprite&&this.fadeSprite.node&&cc.Tween.stopAllByTarget(this.fadeSprite.node)},r([a(cc.Label)],t.prototype,"resultLabel",void 0),r([a(cc.Button)],t.prototype,"restartButton",void 0),r([a(cc.Button)],t.prototype,"continueButton",void 0),r([a(cc.Sprite)],t.prototype,"fadeSprite",void 0),r([a(cc.Sprite)],t.prototype,"curtainSprite",void 0),r([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],"entry-point":[function(e,t,o){"use strict";cc._RF.push(t,"a9aa5EFkiRHk7gsuM2EnD8q","entry-point");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./game"),s=e("./services/serviceLocator"),a=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){console.log("start create game"),this._game=new c.Game(s.ServiceLocator.Container())},r([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./game":"game","./services/serviceLocator":"serviceLocator"}],"game-factory":[function(e,t,o){"use strict";cc._RF.push(t,"a22c79dktBITo5Qf/ubjskH","game-factory");var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function c(e){try{a(n.next(e))}catch(t){r(t)}}function s(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,n=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(s){r=[6,s],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameFactory=void 0;var r=e("../../../configs/configs"),c=e("../../../logic/tile"),s=e("../../../logic/table-cell"),a=e("../../../logic/table/table-view"),l=e("../../../logic/table/table-model"),u=e("../../../ui/ui-panel"),p=e("../../../curtain/curtain"),h=e("../../../logic/table/table-controller"),f=function(){function e(e){this._assetProvider=e}return e.prototype.loadAssets=function(){return n(this,void 0,void 0,function(){var e=this;return i(this,function(t){switch(t.label){case 0:return[4,this._assetProvider.loadAsset(r.PREFABS.curtainPrefab)];case 1:return t.sent(),[4,this._assetProvider.loadAsset(r.PREFABS.tablePrefab)];case 2:return t.sent(),[4,this._assetProvider.loadAsset(r.PREFABS.tilePrefab)];case 3:return t.sent(),[4,this._assetProvider.loadAsset(r.PREFABS.UIPanelPrefab)];case 4:return t.sent(),[4,this._assetProvider.loadAsset(r.PREFABS.BombEffectPrefab)];case 5:return t.sent(),[4,Promise.all(r.TILE_MODELS.map(function(t){return e._assetProvider.loadAsset(t.path)}))];case 6:return t.sent(),[2]}})})},e.prototype.createBombEffect=function(e){try{var t=cc.director.getScene().getChildByName("Canvas"),o=this._assetProvider.instantiateAsset(r.PREFABS.BombEffectPrefab),n=e.convertToWorldSpaceAR(cc.v2(0,0)),i=t.convertToNodeSpaceAR(n);return o.setParent(t),o.setPosition(i),o}catch(c){console.error("Failed to create curtain:",c)}},e.prototype.createTableView=function(){try{return this.instantiateOnCanvas(r.PREFABS.tablePrefab,a.default)}catch(e){console.error("Failed to create table:",e)}},e.prototype.createUiPanelView=function(){try{return this.instantiateOnCanvas(r.PREFABS.UIPanelPrefab,u.default)}catch(e){console.error("Failed to create UI panel:",e)}},e.prototype.createCurtain=function(){try{var e=cc.director.getScene().getChildByName("Canvas"),t=this._assetProvider.instantiateAsset(r.PREFABS.curtainPrefab).getComponent(p.default);return t.node.setParent(e),t.node.setPosition(0,0),t}catch(o){console.error("Failed to create curtain:",o)}},e.prototype.createTableController=function(e,t,o){return new h.TableController(this,e,t,o)},e.prototype.createTableModel=function(e,t){return new l.TableModel(e,t)},e.prototype.createTiles=function(e,t){for(var o=[],n=0;n<e.length;n++){o[n]=[];for(var i=0;i<e[n].length;i++){var r=e[n][i];if(r.isFree()){var c=this.getRandomTileModel(),s=this.createTile(c.tileType,c.sprite,t,r);r.setFree(!1),o[n][i]=s}else o[n][i]=null}}return o},e.prototype.getRandomTileModel=function(){var e=Math.random(),t=Math.floor(e*r.TILE_MODELS.length),o=r.TILE_MODELS[t],n=o.path,i=o.type,c=this._assetProvider.getAsset(n),s=new cc.SpriteFrame;return s.setTexture(c),{tileType:i,sprite:s}},e.prototype.createTile=function(e,t,o,n){try{var i=this._assetProvider.instantiateAsset(r.PREFABS.tilePrefab).getComponent(c.default);return i.node.setParent(o),i.node.setPosition(n.getPosition()),i.Init(e,t),i}catch(s){console.error("Failed to create table:",s)}},e.prototype.createTableCells=function(){for(var e=[],t=Math.floor(Math.random()*r.TABLE.length),o=r.TABLE[t],n=o.column,i=o.lines,c=o.grid,a=o.grid,l=-(n-1)*c/2,u=(i-1)*a/2,p=0;p<n;p++){e[p]=[];for(var h=0;h<i;h++){var f=new cc.Vec2(l+p*c,u-h*a),_=new s.TableCell(p,h,f,!0);e[p][h]=_}}return e},e.prototype.instantiateOnCanvas=function(e,t){var o=cc.director.getScene().getChildByName("Canvas"),n=this._assetProvider.instantiateAsset(e).getComponent(t);return n.node.setParent(o),n.node.setPosition(0,0),n},e}();o.GameFactory=f,cc._RF.pop()},{"../../../configs/configs":"configs","../../../curtain/curtain":"curtain","../../../logic/table-cell":"table-cell","../../../logic/table/table-controller":"table-controller","../../../logic/table/table-model":"table-model","../../../logic/table/table-view":"table-view","../../../logic/tile":"tile","../../../ui/ui-panel":"ui-panel"}],"game-loop-state":[function(e,t,o){"use strict";cc._RF.push(t,"851aeQvhJ1KmZWYl006WD2h","game-loop-state"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameLoopState=void 0;var n=e("../../ui/ui-panel-controller"),i=e("../state-machine/state-names"),r=function(){function e(e,t,o,n){this._isResultShown=!1,this._stateMachine=e,this._progressService=t,this._mechanicService=o,this._gameFactory=n}return e.prototype.run=function(e){var t=this;this._isResultShown=!1,this.resolveImpossibleMoves(e.tableModel,e.tableController);var o=new n.UIPanelController(this._progressService,e.uiPanelView,this._mechanicService,this._gameFactory);e.tableController.onBurn=function(n){t._progressService.nextStep(n),o.updateScore(),t._isResultShown||t.resolveImpossibleMoves(e.tableModel,e.tableController)},this._progressService.onWin=function(){t.handleGameEnd(i.StateNames.Win,e.tableController)},this._progressService.onLose=function(){t.handleGameEnd(i.StateNames.Lose,e.tableController)}},e.prototype.resolveImpossibleMoves=function(e,t){this.hasPossibleMoves(e)||(console.log("tails count after result ",e.getTiles().length),this.handleGameEnd(i.StateNames.Lose,t))},e.prototype.handleGameEnd=function(e,t){this._isResultShown=!0,this._progressService.resetResults(),this._progressService.resetSteps(),t.clearTable(),this._stateMachine.run(e),console.log("GAME END ",e)},e.prototype.stop=function(){},e.prototype.hasPossibleMoves=function(e){for(var t=e.getTiles(),o=t.length,n=t[0].length,i=0;i<o;i++)for(var r=0;r<n;r++){var c=t[i][r];if(c)for(var s=0,a=[{x:i+1,y:r},{x:i,y:r+1},{x:i-1,y:r},{x:i,y:r-1}];s<a.length;s++){var l=a[s];if(this.isValidPosition(l.x,l.y,o,n)){var u=t[l.x][l.y];if(u&&u.tileType===c.tileType)return!0}}}return!1},e.prototype.isValidPosition=function(e,t,o,n){return e>=0&&e<o&&t>=0&&t<n},e}();o.GameLoopState=r,cc._RF.pop()},{"../../ui/ui-panel-controller":"ui-panel-controller","../state-machine/state-names":"state-names"}],"game-mechanic":[function(e,t,o){"use strict";cc._RF.push(t,"665bafOwBlEUZdBQC7YO+W7","game-mechanic"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],"game-state-machine":[function(e,t,o){"use strict";cc._RF.push(t,"336a1fdwvFLYaOGZ3QrUEMe","game-state-machine"),Object.defineProperty(o,"__esModule",{value:!0}),o.StateMachine=void 0;var n=e("../states/create-content-state"),i=e("../services/gameFactory/game-factory"),r=e("../states/game-loop-state"),c=e("../services/progress-service"),s=e("../states/win-state"),a=e("../states/lose-state"),l=e("../services/mechanic-service"),u=e("../states/initialize-state"),p=function(){function e(e){this.currentState=null,console.log("start register process states in state machine"),this.registerStates(e),console.log("end register process")}return e.prototype.registerStates=function(e){this._states={InitializeState:new u.InitializeState(this,e),CreateContentState:new n.CreateContentState(this,e.single(i.GameFactory),e.single(l.MechanicService)),GameLoopState:new r.GameLoopState(this,e.single(c.ProgressService),e.single(l.MechanicService),e.single(i.GameFactory)),WinState:new s.WinState(this,e.single(i.GameFactory)),LoseState:new a.LoseState(this,e.single(i.GameFactory))},console.log("States registered:",Object.keys(this._states))},e.prototype.run=function(e,t){var o,n=this._states[e];n?(null===(o=this.currentState)||void 0===o||o.stop(),this.currentState=n,n.run(t)):console.error("State not registered:",e,"/ all keys: "+Object.keys(this._states))},e}();o.StateMachine=p,cc._RF.pop()},{"../services/gameFactory/game-factory":"game-factory","../services/mechanic-service":"mechanic-service","../services/progress-service":"progress-service","../states/create-content-state":"create-content-state","../states/game-loop-state":"game-loop-state","../states/initialize-state":"initialize-state","../states/lose-state":"lose-state","../states/win-state":"win-state"}],game:[function(e,t,o){"use strict";cc._RF.push(t,"9468cogMLRPSL1kSlPBKw9q","game"),Object.defineProperty(o,"__esModule",{value:!0}),o.Game=void 0;var n=e("./state-machine/game-state-machine"),i=e("./state-machine/state-names");o.Game=function(e){console.log("start create state machine"),this.stateMachine=new n.StateMachine(e),console.log("this.stateMachine.run(StateNames.Initialize);  / StateArgument:",i.StateNames.Initialize),this.stateMachine.run(i.StateNames.Initialize)},cc._RF.pop()},{"./state-machine/game-state-machine":"game-state-machine","./state-machine/state-names":"state-names"}],"initialize-state":[function(e,t,o){"use strict";cc._RF.push(t,"81e10bI9VtLoLLZzzBQMAT3","initialize-state"),Object.defineProperty(o,"__esModule",{value:!0}),o.InitializeState=void 0;var n=e("../services/gameFactory/asset-provider"),i=e("../services/gameFactory/game-factory"),r=e("../services/mechanic-service"),c=e("../services/progress-service"),s=e("../state-machine/state-names"),a=function(){function e(e,t){this._stateMachine=e,this._serviceLocator=t,console.log("run RegisterDependecies");var o=new n.AssetProvider,s=new i.GameFactory(o),a=new c.ProgressService(e),l=new r.MechanicService(s);this._serviceLocator.registerSingle(o),this._serviceLocator.registerSingle(s),this._serviceLocator.registerSingle(a),this._serviceLocator.registerSingle(l)}return e.prototype.run=function(){this._stateMachine.run(s.StateNames.CreateContent)},e.prototype.stop=function(){console.log("Stopping RegisterDependecies")},e}();o.InitializeState=a,cc._RF.pop()},{"../services/gameFactory/asset-provider":"asset-provider","../services/gameFactory/game-factory":"game-factory","../services/mechanic-service":"mechanic-service","../services/progress-service":"progress-service","../state-machine/state-names":"state-names"}],"lose-state":[function(e,t,o){"use strict";cc._RF.push(t,"d3b5dzseGNHqIYzj9tpg8xw","lose-state"),Object.defineProperty(o,"__esModule",{value:!0}),o.LoseState=void 0;var n=e("../state-machine/state-names"),i=function(){function e(e,t){this._stateMachine=e,this._gameFactory=t}return e.prototype.run=function(){var e=this,t=this._gameFactory.createCurtain();t.lose(),t.onRestart=function(){e._stateMachine.run(n.StateNames.CreateContent)}},e.prototype.stop=function(){},e}();o.LoseState=i,cc._RF.pop()},{"../state-machine/state-names":"state-names"}],"mechanic-service":[function(e,t,o){"use strict";cc._RF.push(t,"30792Eely5HPq4H0vVw7VjX","mechanic-service"),Object.defineProperty(o,"__esModule",{value:!0}),o.MechanicService=void 0;var n=e("../../logic/game-mechanic/basic-mechanic"),i=function(){function e(e){this._gameFactory=e,this._mechanics=[],this._activeMechanic=null}return e.prototype.init=function(e){this._mechanics=e},e.prototype.setActiveMechanic=function(e){this._activeMechanic=e},e.prototype.activeMechanic=function(){return this._activeMechanic},e.prototype.getMechanicByType=function(e){return this._mechanics.find(function(t){return t instanceof e})},e.prototype.onTileClick=function(e,t){this._activeMechanic&&this._activeMechanic.onTileClick&&(this._activeMechanic.onTileClick(e,t),this._activeMechanic instanceof n.BasicMechanic||this.setActiveMechanic(this.getMechanicByType(n.BasicMechanic)))},e.prototype.onTurnEnd=function(){for(var e=0,t=this._mechanics;e<t.length;e++){var o=t[e];o.onTurnEnd&&o.onTurnEnd()}},e}();o.MechanicService=i,cc._RF.pop()},{"../../logic/game-mechanic/basic-mechanic":"basic-mechanic"}],"progress-service":[function(e,t,o){"use strict";cc._RF.push(t,"812feIiTvdLc4oN9HueiLLu","progress-service"),Object.defineProperty(o,"__esModule",{value:!0}),o.ProgressService=void 0;var n=e("../../configs/configs"),i=function(){function e(e){this._stateMachine=e,this.currentScore=0,this.isGameOver=!1,this.MaxStep=n.GLOBAL_GAME_CONFIGS.MaxStep,this.remainingSteps=n.GLOBAL_GAME_CONFIGS.MaxStep,this.WinScoreThreshold=n.GLOBAL_GAME_CONFIGS.WinScoreThreshold,this._scoreFormula=n.GLOBAL_GAME_CONFIGS.ScoreFormula}return e.prototype.nextStep=function(e){e>1&&(this.currentScore+=this.calculateScoreForBurnedGroup(e)),this.remainingSteps--,this.checkGameOver()},e.prototype.calculateScoreForBurnedGroup=function(e){return this._scoreFormula(e)},e.prototype.checkGameOver=function(){return this.currentScore>=this.WinScoreThreshold?(this.isGameOver=!0,this.onWin&&this.onWin()):this.remainingSteps<=0&&(this.isGameOver=!0,this.onLose&&this.onLose()),this.isGameOver},e.prototype.resetResults=function(){this.currentScore=0,this.isGameOver=!1},e.prototype.resetSteps=function(){this.remainingSteps=n.GLOBAL_GAME_CONFIGS.MaxStep},e}();o.ProgressService=i,cc._RF.pop()},{"../../configs/configs":"configs"}],serviceLocator:[function(e,t,o){"use strict";cc._RF.push(t,"88f5eQRvnVHrrLNqMv4pZz4","serviceLocator"),Object.defineProperty(o,"__esModule",{value:!0}),o.ServiceLocator=void 0;var n=function(){function e(){this._services=new Map}return e.Container=function(){return null==this._instance&&(console.log("start create sl instance"),this._instance=new e),this._instance},e.prototype.registerSingle=function(e){console.log("register service ",e);var t=e.constructor;this._services.set(t,e)},e.prototype.single=function(e){var t=e||this.getType();console.log("get service ",t);var o=this._services.get(t);if(!o)throw new Error("Service "+t.name+" not registered");return o},e.prototype.getType=function(){return function(){function e(){}return Object.defineProperty(e,"type",{get:function(){return null},enumerable:!1,configurable:!0}),e}().type},e._instance=null,e}();o.ServiceLocator=n,cc._RF.pop()},{}],"state-interfaces":[function(e,t,o){"use strict";cc._RF.push(t,"29c27EKHOZP4rR/N9FD/J+j","state-interfaces"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],"state-names":[function(e,t,o){"use strict";cc._RF.push(t,"65c9bUSiwlCnKTH+x0fnB4w","state-names"),Object.defineProperty(o,"__esModule",{value:!0}),o.StateNames=void 0,function(e){e.Initialize="InitializeState",e.CreateContent="CreateContentState",e.GameLoop="GameLoopState",e.Win="WinState",e.Lose="LoseState"}(o.StateNames||(o.StateNames={})),cc._RF.pop()},{}],"table-cell":[function(e,t,o){"use strict";cc._RF.push(t,"a81d6FR5B1L3J9CL7/mJKj9","table-cell"),Object.defineProperty(o,"__esModule",{value:!0}),o.TableCell=void 0;var n=function(){function e(e,t,o,n){this._collumn=e,this._line=t,this._position=o,this._free=n}return e.prototype.getCollumn=function(){return this._collumn},e.prototype.getLine=function(){return this._line},e.prototype.getPosition=function(){return this._position},e.prototype.isFree=function(){return this._free},e.prototype.setFree=function(e){this._free=e},e}();o.TableCell=n,cc._RF.pop()},{}],"table-controller":[function(e,t,o){"use strict";cc._RF.push(t,"c9ddcY2gbtJkodXTJ05g77E","table-controller"),Object.defineProperty(o,"__esModule",{value:!0}),o.TableController=void 0;var n=e("../game-mechanic/basic-mechanic"),i=e("../game-mechanic/booster-bomb"),r=function(){function e(e,t,o,r){this._gameFactory=e,this._tableView=t,this._model=o,this._mechanicService=r;var c=new n.BasicMechanic,s=new i.BoosterBomb(e);this._mechanicService.init([c,s]),this._mechanicService.setActiveMechanic(c),this.init()}return e.prototype.getTile=function(e,t){return this._model.getTiles()[e][t]},e.prototype.setTile=function(e,t,o){this._model.getTiles()[e][t]=o},e.prototype.getCell=function(e,t){return this._model.getTableCells()[e][t]},e.prototype.getTilePosition=function(e){for(var t=this._model.getTiles(),o=0;o<t.length;o++)for(var n=0;n<t[o].length;n++)if(t[o][n]===e)return{col:o,row:n};return{col:-1,row:-1}},e.prototype.getTileCount=function(){var e,t=this._model.getTiles();return{columns:t.length,rows:(null===(e=t[0])||void 0===e?void 0:e.length)||0}},e.prototype.removeTile=function(e){this._tableView.removeTile(e)},e.prototype.moveTile=function(e,t){this._tableView.moveTile(e,t)},e.prototype.addTile=function(e,t){var o=this;this._tableView.addTile(e,t),e.sprite.node.on(cc.Node.EventType.TOUCH_END,function(){return o.onTileClick(e)},this)},e.prototype.createRandomTile=function(e){var t=this._gameFactory.getRandomTileModel();return this._gameFactory.createTile(t.tileType,t.sprite,this._tableView.getContent(),e)},e.prototype.init=function(){for(var e=this,t=this._model.getTiles(),o=this._model.getTableCells(),n=0;n<t.length;n++)for(var i=function(i){var c=t[n][i];c&&(c.sprite.node.on(cc.Node.EventType.TOUCH_END,function(){return e.onTileClick(c)},r),r._tableView.addTile(c,o[n][i]))},r=this,c=0;c<t[n].length;c++)i(c)},e.prototype.onTileClick=function(e){this._mechanicService.onTileClick(e,this)},e.prototype.onTurnEnd=function(){this._mechanicService.onTurnEnd(this)},e.prototype.clearTable=function(){for(var e=this,t=this._model.getTiles(),o=this._model.getTableCells(),n=0;n<t.length;n++)for(var i=function(i){var c=t[n][i];c&&(c.sprite.node.off(cc.Node.EventType.TOUCH_END,function(){return e.onTileClick(c)},r),r._tableView.removeTile(c),t[n][i]=null,o[n][i].setFree(!0))},r=this,c=0;c<t[n].length;c++)i(c)},e}();o.TableController=r,cc._RF.pop()},{"../game-mechanic/basic-mechanic":"basic-mechanic","../game-mechanic/booster-bomb":"booster-bomb"}],"table-model":[function(e,t,o){"use strict";cc._RF.push(t,"3b989ANl/JOebF4QGCb12uD","table-model"),Object.defineProperty(o,"__esModule",{value:!0}),o.TableModel=void 0;var n=function(){function e(e,t){this._tableCells=e,this._tiles=t}return e.prototype.getTableCells=function(){return this._tableCells},e.prototype.getTiles=function(){return this._tiles},e}();o.TableModel=n,cc._RF.pop()},{}],"table-view":[function(e,t,o){"use strict";cc._RF.push(t,"4b047pohDRFQLwMp8UszKEN","table-view");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t}return i(t,e),t.prototype.getContent=function(){return this.content},t.prototype.addTile=function(e,t){e.node.setParent(this.content),e.node.setPosition(t.getPosition()),e.node.scale=0,e.node.angle=0,cc.tween(e.node).delay(.2).to(.3,{scale:1},{easing:"backOut"}).call(function(){cc.tween(e.node).to(.2,{angle:-12},{easing:"sineInOut"}).start()}).start()},t.prototype.explosion=function(e){cc.tween(e.node).to(.1,{scale:0},{easing:"backIn"}).call(function(){e.node.destroy()}).start()},t.prototype.removeTile=function(e){cc.tween(e.node).to(.1,{scale:0},{easing:"backIn"}).call(function(){e.node.destroy()}).start()},t.prototype.moveTile=function(e,t){cc.tween(e.node).to(.3,{y:t.y},{easing:"quadOut"}).start()},r([a(cc.Node)],t.prototype,"content",void 0),r([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],"tile-type":[function(e,t,o){"use strict";cc._RF.push(t,"aea94/hd0xMD5AOW4/Aanlr","tile-type"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileType=void 0,function(e){e.BLUE="blue",e.RED="red",e.GREEN="green",e.PURPLE="purple",e.YELLOW="yellow"}(o.TileType||(o.TileType={})),cc._RF.pop()},{}],tile:[function(e,t,o){"use strict";cc._RF.push(t,"9b4fe3dd5ZMh5e6wycNirgR","tile");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./tile-type"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tileType=c.TileType.BLUE,t.sprite=null,t}return i(t,e),t.prototype.Init=function(e,t){this.tileType=e,this.sprite.spriteFrame=t},r([l],t.prototype,"tileType",void 0),r([l(cc.Sprite)],t.prototype,"sprite",void 0),r([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./tile-type":"tile-type"}],"ui-panel-controller":[function(e,t,o){"use strict";cc._RF.push(t,"8518arjEn9Ph5v3L4uBwp+/","ui-panel-controller"),Object.defineProperty(o,"__esModule",{value:!0}),o.UIPanelController=void 0;var n=e("../logic/game-mechanic/basic-mechanic"),i=e("../logic/game-mechanic/booster-bomb"),r=function(){function e(e,t,o,n){this._progressService=e,this._uiPanelView=t,this._mechanicService=o,this._gameFactory=n,this._bombTrial=3,this.start()}return e.prototype.start=function(){var e=this;this._uiPanelView.init(this._progressService.WinScoreThreshold,this._progressService.MaxStep),this._uiPanelView.showBombCount(this._bombTrial),this._uiPanelView.onClickBomb=function(){e._mechanicService.activeMechanic()instanceof n.BasicMechanic&&(e._bombTrial>0?(e._uiPanelView.bombButtonActive(!0),e.setActiveBomb(),e._bombTrial-=1,0===e._bombTrial&&e._uiPanelView.bombButtonActive(!1)):e._uiPanelView.bombButtonActive(!1),e._uiPanelView.showBombCount(e._bombTrial))}},e.prototype.updateScore=function(){this._uiPanelView.updateScore(this._progressService.currentScore),this._uiPanelView.updateStep(this._progressService.remainingSteps)},e.prototype.setActiveBomb=function(){this._mechanicService.setActiveMechanic(this._mechanicService.getMechanicByType(i.BoosterBomb))},e}();o.UIPanelController=r,cc._RF.pop()},{"../logic/game-mechanic/basic-mechanic":"basic-mechanic","../logic/game-mechanic/booster-bomb":"booster-bomb"}],"ui-panel":[function(e,t,o){"use strict";cc._RF.push(t,"954b3K6+QRPn4GSO3PV9Dl7","ui-panel");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stepsLabel=null,t.scoreLabel=null,t.countBombLabel=null,t.bombButton=null,t}return i(t,e),t.prototype.init=function(e,t){this._winScore=e,this.stepsLabel.string=t.toString(),this.scoreLabel.string="0/"+e,this.bombButton.node.on(cc.Node.EventType.TOUCH_END,this.clickBomb,this),this.bombButtonActive(!0)},t.prototype.updateScore=function(e){this.scoreLabel.string=e+"/"+this._winScore,this.animateLabel(this.scoreLabel,.3)},t.prototype.updateStep=function(e){this.stepsLabel.string=e.toString(),this.animateLabel(this.stepsLabel,.5)},t.prototype.showBombCount=function(e){this.countBombLabel.string=e.toString(),this.animateLabel(this.countBombLabel,.5)},t.prototype.bombButtonActive=function(e){var t=this.bombButton.node;cc.Tween.stopAllByTarget(t),this.animateButton(t,e)},t.prototype.clickBomb=function(){this.onClickBomb&&this.onClickBomb()},t.prototype.animateButton=function(e,t){t?(e.active=!0,e.opacity=255,e.scale=1,e.color=cc.Color.WHITE,cc.tween(e).to(.15,{scale:1.18},{easing:"backOut"}).to(.12,{scale:1},{easing:"backIn"}).start()):cc.tween(e).to(.25,{scale:.92},{easing:"quadIn"}).call(function(){e.color=new cc.Color(180,180,180)}).start()},t.prototype.animateLabel=function(e,t){e&&e.node&&cc.tween(e.node).to(t,{scale:1.2},{easing:"quadOut"}).to(.1,{scale:1},{easing:"quadIn"}).start()},t.prototype.onDestroy=function(){var e,t;null===(t=null===(e=this.bombButton)||void 0===e?void 0:e.node)||void 0===t||t.off(cc.Node.EventType.TOUCH_END,this.clickBomb,this)},r([a(cc.Label)],t.prototype,"stepsLabel",void 0),r([a(cc.Label)],t.prototype,"scoreLabel",void 0),r([a(cc.Label)],t.prototype,"countBombLabel",void 0),r([a(cc.Button)],t.prototype,"bombButton",void 0),r([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],"win-state":[function(e,t,o){"use strict";cc._RF.push(t,"e533a+cKk9AKIpmBlHRj4t8","win-state"),Object.defineProperty(o,"__esModule",{value:!0}),o.WinState=void 0;var n=e("../state-machine/state-names"),i=function(){function e(e,t){this._stateMachine=e,this._gameFactory=t}return e.prototype.run=function(){var e=this,t=this._gameFactory.createCurtain();t.win(),t.onContinue=function(){e._stateMachine.run(n.StateNames.CreateContent)}},e.prototype.stop=function(){},e}();o.WinState=i,cc._RF.pop()},{"../state-machine/state-names":"state-names"}]},{},["configs","curtain","entry-point","game","asset-provider","game-factory","mechanic-service","progress-service","serviceLocator","game-state-machine","state-interfaces","state-names","create-content-state","game-loop-state","initialize-state","lose-state","win-state","abstract-machanic","basic-mechanic","booster-bomb","game-mechanic","table-cell","table-controller","table-model","table-view","tile-type","tile","ui-panel-controller","ui-panel"]);